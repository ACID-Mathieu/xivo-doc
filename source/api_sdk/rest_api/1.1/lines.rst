*****
Lines
*****

Line Representation
===================

The representation of a line slightly differs depending on its protocol.

**Description**

id
   *read-only* **integer**

context
   **string**

   The name of an internal context.

protocol
   *read-only* **string**

   Must be ``sip`` for now.

interface
   **string**

   The interface of the custom line. Example: ``SIP/abcdef`` or ``Local/123@default``.

links
   **list**
   
   The link to the resource.

**SIP example**::

   {
      "id": 1,
      "context": "default",
      "protocol": "sip",
      "interface": "sip/abcdef",
      "links" : [
         {
            "rel": "lines_sip",
            "href": "https://xivoserver/1.1/lines_sip/1"
         }
      ]
   }

**Custom example**

.. warning:: Not yet implemented

::
   
   {
      "id": 2,
      "context": "default",
      "protocol": "custom",
      "interface": "Local/123@default",
      "links" : [
         {
            "rel": "lines_custom",
            "href": "https://xivoserver/1.1/lines_custom/2"
         }
      ]
   }

**SCCP example**

.. warning:: Not yet implemented

::

   {
      "id": 3,
      "context": "default",
      "protocol": "sccp",
      "interface": "sccp/1234",
      "links" : [
         {
            "rel": "lines_sccp",
            "href": "https://xivoserver/1.1/lines_sccp/3"
         }
      ]
   }


List Lines
==========

List all lines. The resource ``/lines`` is only for to list 

::

   GET /1.1/lines

**Example request**::

   GET /1.1/lines HTTP/1.1
   Host: xivoserver
   Accept: application/json

**Example response**::

   HTTP/1.1 200 OK
   Content-Type: application/json

   {
       "total": 3,
       "items": [
           {
               "id": 1,
               "context": "default",
               "protocol": "sip",
               "interface": "sip/abcdef",
               "links" : [
                  {
                     "rel": "lines_sip",
                     "href": "https://xivoserver/1.1/lines_sip/1"
                  }
               ]
           },
           {
               "id": 2,
               "context": "default",
               "protocol": "custom",
               "interface": "Local/123@default"
               "links" : [
                  {
                     "rel": "lines_custom",
                     "href": "https://xivoserver/1.1/lines_custom/2"
                  }
               ]
           },
           {
               "id": 3,
               "context": "default",
               "protocol": "sccp",
               "interface": "sccp/1234"
               "links" : [
                  {
                     "rel": "lines_sccp",
                     "href": "https://xivoserver/1.1/lines_sccp/3"
                  }
               ]
           }
       ]
   }


Get SIP Line
============

Return a SIP line.

::

   GET /1.1/lines_sip/<id>

**Example request**::

   GET /1.1/lines_sip/1 HTTP/1.1
   Host: xivoserver
   Accept: application/json

**Example response**::

   HTTP/1.1 200 OK
   Content-Type: application/json

   {
      "id": 1,
      "context": "default",
      "interface": "sip/abcdef",
      "username": "abcdef",
      "secret": "password",
      "provisioning_extension": "123456",
      "commented": 0,
      "description": "line blue"
   }


Create SIP Line
===============

Create a SIP line.

The SIP username and password are autogenerated.

::

   POST /1.1/lines_sip

**Input**

context
   *required*

**Example request**::

   POST /1.1/lines_sip HTTP/1.1
   Host: xivoserver
   Accept: application/json
   Content-Type: application/json

   {
       "context": "default"
   }

**Example response**::

   HTTP/1.1 201 Created
   Location: /1.1/lines/1
   Content-Type: application/json

   {
      "id": 1,
      "links" : [
         {
            "rel": "lines_sip",
            "href": "https://xivoserver/1.1/lines_sip/1"
         }
      ]
   }


Create Custom Line
==================

.. warning:: Not yet implemented

Create a custom line.

::

   POST /1.1/lines_custom

**Input**

context
   *required*

interface
   *required*


**Example request**::

   POST /1.1/lines_custom HTTP/1.1
   Host: xivoserver
   Accept: application/json
   Content-Type: application/json

   {
       "context": "default",
       "interface": "Local/4185559999@to-extern"
   }

**Example response**::

   HTTP/1.1 201 Created
   Location: /1.1/lines_custom/2
   Content-Type: application/json

   {
      "id": 2,
      "links" : [
         {
            "rel": "lines_custom",
            "href": "https://xivoserver/1.1/lines_custom/2"
         }
      ]
   }


Delete SIP Line
===============

Delete a SIP line.

For every user that is associated to the line, the association between the
line and the user is removed.

If the line is provisioned to a device, the association between the line
and the device is removed. If that device had exactly 1 line provisioned
on it, the device goes back in autoprov mode.

::

   DELETE /1.1/lines_sip/<id>

**Example request**::

   DELETE /1.1/lines_sip/1 HTTP/1.1
   Host: xivoserver

**Example response**::

   HTTP/1.1 204 No Content
