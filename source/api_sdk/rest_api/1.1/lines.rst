*****
Lines
*****

Line Representation
===================

The representation of a line slightly differs depending on its protocol.

**Description**

id
   *read-only* **integer**

context
   **string**

   The name of an internal context.

protocol
   *read-only* **string**

   One of ``sip`` or ``custom``.

protocol_sip.username
   **string**

   SIP line only.

.. _line-proto-custom-iface:

protocol_custom.interface
   **string**

   Custom line only.

   The interface of the custom line. Example: ``SIP/abcdef`` or ``Local/123@default``.

**SIP example**::

   {
       "id": 1,
       "context": "default",
       "protocol": "sip",
       "protocol_sip": {
           "username": "abcdef"
       }
   }

**Custom example**::

   {
       "id": 2,
       "context": "default",
       "protocol": "custom",
       "protocol_custom": {
           "interface": "SIP/abcdef"
       }
   }


List Lines
==========

List all lines.

::

   GET /1.1/lines

**Example request**::

   GET /1.1/lines HTTP/1.1
   Host: xivoserver
   Accept: application/json

**Example response**::

   HTTP/1.1 200 OK
   Content-Type: application/json

   {
       "total": 2,
       "items": [
           {
               "id": 1,
               "context": "default",
               "protocol": "sip",
               "protocol_sip": {
                   "username": "abcdef"
               }
           },
           {
               "id": 2,
               "context": "default",
               "protocol": "custom",
               "protocol_custom": {
                   "interface": "SIP/abcdef"
               }
           }
       ]
   }


Get Line
========

Return a line.

::

   GET /1.1/lines/<id>

**Example request**::

   GET /1.1/lines/1 HTTP/1.1
   Host: xivoserver
   Accept: application/json

**Example response**::

   HTTP/1.1 200 OK
   Content-Type: application/json

   {
      "id": 1,
      "context": "default",
      "protocol": "sip",
      "protocol_sip": {
          "username": "abcdef"
      }
   }


Create SIP Line
===============

Create a SIP line.

The SIP username and password are autogenerated.

::

   POST /1.1/lines

**Input**

context
   *optional*

   If unspecified, an internal context is picked. You should specify this field
   if you have more than 1 internal context.

protocol
   *required*

   Must be set to ``sip``.

**Example request**::

   POST /1.1/lines HTTP/1.1
   Host: xivoserver
   Accept: application/json
   Content-Type: application/json

   {
       "context": "default",
       "protocol": "sip",
   }

**Example response**::

   HTTP/1.1 201 Created
   Location: /1.1/lines/1
   Content-Type: application/json

   {
       "id": 1
   }


Create Custom Line
==================

Create a custom line.

::

   POST /1.1/lines

**Input**

context
   *optional*

   If unspecified, an internal context is picked. You should specify this field
   if you have more than 1 internal context.

protocol
   *required*

   Must be set to ``custom``.

:ref:`protocol_custom.interface <line-proto-custom-iface>`
   *required*

**Example request**::

   POST /1.1/lines HTTP/1.1
   Host: xivoserver
   Accept: application/json
   Content-Type: application/json

   {
       "context": "default",
       "protocol": "custom",
       "protocol_custom": {
           "interface": "SIP/abcdef"
       }
   }

**Example response**::

   HTTP/1.1 201 Created
   Location: /1.1/lines/2
   Content-Type: application/json

   {
       "id": 2
   }


Delete Line
===========

Delete a line.

For every user that is associated to the line, the association between the
line and the user is removed.

If the line is provisioned to a device, the association between the line
and the device is removed. If that device had exactly 1 line provisioned
on it, the device goes back in autoprov mode.

::

   DELETE /1.1/lines/<id>

**Example request**::

   DELETE /1.1/lines/1 HTTP/1.1
   Host: xivoserver

**Example response**::

   HTTP/1.1 204 No Content
